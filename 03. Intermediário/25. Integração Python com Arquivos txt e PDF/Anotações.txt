AULA_01: Lendo Arquivos txt

    Manipulação de arquivos txt.
    
    Método open: -> Abre um arquivo txt
        arquivo = open('NomeArquivo.txt', 'r')
    
    ler o arquivo com os métodos
        2. Método read():
            texto_arquivo = arquivo.read()
        3. Método readlines():
            lista_linhas = arquivo.readlines()


AULA_02: Escrevendo em Arquivo txt

    Criação de um arquivo txt.
        novo_arquivo = open('Resumo.txt', 'w')

    Para escrever alguma coisa no arquivo:
        4. Método write():
            arquivo.write('Texto que quero escrever')

    Fechar o arquivo:
        5. Método close():
            arquivo.close()


AULA_03: Método With

    Estrutura que abre e fecha o arquivo automatico (Funcionando com uma função).

    6. Usando a estrutura with: -> ao final do with, a própria estrutura with fecha automaticamente o arquivo
        with open('NomeArquivo.txt', 'w') as arquivo:
            arquivo.write()


AULA_04: Explicação Desafio Python txt

    Explicação do Desafio


AULA_05: Solução Desafio Python txt - Parte 1

    Deletando os elemento desnecessarios do arquivo;

    Separando os emails das origens;


AULA_06: Solução Desafio Python txt - Parte 2

    Separação da quantidade de cada origem dos leads.


AULA_07: Solução Desafio Python txt - Parte 3

    Enviando os Indicadores para um arquivo txt.


AULA_08: Mentoria - Leitura de XML e Notas Fiscais com Python

    Objetivo do projeto: Extrair dados das notas fidcais atraves do XML.

    Biblioteca:
        xmltodict

    Extraindo os dados em um dicionario:
        with open('NFs Finais/DANFEBrota.xml', 'rb') as arquivo:
            documento = xmltodict.parse(arquivo)

    Extraindo dados especificos do XML:
        pprint.pprint(documento['nfeProc']['NFe']['infNFe']['dest']['CPF'])
    
    Extrair cada elemento do dicionario:
        for item in documento['nfeProc']['NFe']:
            print(item)
    
    Adicionando caminho do dicionario a uma variavel:
        dic_nf = documento['nfeProc']['NFe']['infNFe']
    
    Extraindo dados dos produtos e inserindo na lista:
        lista_produtos = []
        produtos = dic_nf['det']
        for produto in produtos:
            valor_produto = produto['prod']['vProd']
            nome_produto = produto['prod']['xProd']
            lista_produtos.append((nome_produto, valor_produto))
    
    *Essa extração de dados em notas fiscais de PRODUTOS, Funciona em qualquer Nota Fiscal (mesmo formato em todo País):
        Basta troca o diretorio da Nota no seguinte trecho:
            with open('NFs Finais/DANFENespresso.xml', 'rb')

    Criar DataFrame a partir de um Dicionario:
        df_tabela = pd.DataFrame.from_dict(resposta)
    
    Exportar para excel, sem repetir linhas:
        resposta = {
            'Valor Total': [valor_total],
            'CNPJ Vendedor': [cnpj_vendeu],
            'Razão Social': [nome_vendeu],
            'CPF Comprador': [cpf_comprou],
            'Nome Comprador': [nome_comprou],
            'Lista de Produtos': [lista_produtos]
        }
        *Passa todos valores com uma lista, pois uma coluna tem mais linhas que outra.
    
    Passa codigo para uma função:
        def ler_xml_danfe(nota):
        ###
        return(resposta)
    
    Rodar script em varios arquivos da pasta:
        import os
        lista_arquivos = os.listdir('NFs Finais')
        for arquivo in lista_arquivos:
            if 'xml' in arquivo:
                if 'DANFE' in arquivo:
                    ler_xml_danfe(f'NFs Finais/{arquivo}')

    Inserir cada dicionario de resposta em uma lista:
        respostas.append(ler_xml_danfe(f'NFs Finais/{arquivo}'))
    
    Passa lista para DF e exporta para Excel:
        df_tabela = pd.DataFrame(respostas)
        df_tabela.to_excel('NFs.xlsx')


AULA_09: Mentoria - Integração Python e Word

    Verificar documentação: https://python-docx.readthedocs.io/en/latest/

    Estrutura Basica:
        documento = Document()
        faturmaento = 1000
        texto = f"""Paulo
                Bom dia!
                O faturamento da empresa ontem foi de R${faturmaento}
                Att."""
        paragrafo = documento.add_paragraph(texto)
        documento.save('Texto.docx')
            #Criando o documento
            #Adicionando Texto
            #Salvando arquivo
    
    Estilo de paragrafo:
        #Edição do estilo
        paragrafo.style = documento.styles.add_style("EstiloPaulo", WD_STYLE_TYPE.PARAGRAPH)
        paragrafo.style.font.name = 'Algerian'
        paragrafo.style.font.size = Pt(15)
        paragrafo.style.font.bold = True

        #Adicionando estilo ao paragrafo
        paragrafo_2 = documento.add_paragraph("Quantidade de produtos vendidos: 10", "EstiloPaulo")

    Adicionando Estilo diferente no meio do paragrafo:
        texto = f"""Paulo O faturamento da empresa ontem foi de"""
        resultado = f"""R${faturmaento}"""
        texto_final = """Att."""

        paragrafo = documento.add_paragraph(texto)
        paragrafo.add_run(resultado).bold = True
        paragrafo = documento.add_paragraph(texto_final)

    Editando margem e seção:
        from docx.enum.text import WD_PARAGRAPH_ALIGNMENT
        documento = Document()

        for secao in documento.sections:
            secao.top_margin = Cm(0.5)
            secao.bottom_margin = Cm(1)
            secao.left_margin = Cm(1)
            secao.right_margin = Cm(1)

        paragrafo = documento.add_paragraph(texto)
        paragrafo.alignment = WD_PARAGRAPH_ALIGNMENT.CENTER

    Adicionando imagem:
        imagem = documento.add_picture('eu.jpeg', width=Cm(8))

    Inserir Tabel:
        Conferir documentação.

    Troca dinamica das palavras:
        dicionario_valores = {

        }
        for paragrafo in documento.paragraphs:
            for codigo in dicionario_valores:
                if codigo in paragrafo.text:
                    paragrafo.text = paragrafo.text.replace(codigo, dicionario_valores[codigo])
    

AULA_10: Integração Python e PDF - Como funciona

    Verificar documentação:
        tabula-py: https://pypdf.readthedocs.io/en/stable/
        pypdf: https://pypdf.readthedocs.io/en/stable/
    
    Instalação das Bibliotecas:
        %pip install pypdf2
        %pip install tabula-py


AULA_11: Separar páginas e Criar PDF

    Estrutura para separa pagunas de um arquivo PDF

    for i, pagina in enumerate(arquivo_pdf.pages):
        num = i + 1
        novo_pdf = pyf.PdfWriter()
        novo_pdf.add_page(pagina)
        with Path(f"paginas/Pagina {num}.pdf").open(mode="wb") as arquivo:
            novo_pdf.write(arquivo)


AULA_12: Juntar e Mesclar PDFs

    Juntar varios arquivos em um unico PDF

        Juntar Varias paginas de diferentes arquivos:
            num_paginas = [1, 14, 16]
            novo_arquivo = pyf.PdfWriter()

            for num in num_paginas:
                pagina_pdf = pyf.PdfReader(f"paginas/Pagina {num}.pdf")
                novo_arquivo.add_page(pagina_pdf.pages[0])

            with Path(f"Consolidado.pdf").open(mode='wb') as arquivo:
                novo_arquivo.write(arquivo)

        Juntar diferentes arquivos:
            pdf_mesclado = pyf.PdfMerger()

            pdf_mesclado.append('MGLU_ER_3T20_POR.pdf')
            pdf_mesclado.append('MGLU_ER_4T20_POR.pdf')

            with Path(f"Mesclado.pdf").open(mode='wb') as arquivo:
                novo_arquivo.write(arquivo)

